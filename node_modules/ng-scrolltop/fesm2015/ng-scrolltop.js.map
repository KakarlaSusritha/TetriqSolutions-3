{"version":3,"file":"ng-scrolltop.js","sources":["ng://ng-scrolltop/lib/ng-scrolltop.service.ts","ng://ng-scrolltop/lib/ng-scrolltop.component.ts","ng://ng-scrolltop/lib/ng-scrolltop.directive.ts","ng://ng-scrolltop/lib/ng-scrolltop.module.ts"],"sourcesContent":["import { Injectable, isDevMode } from '@angular/core';\r\n\r\nconst DEFAULT_SCROLLED_PX = 500;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgScrolltopService {\r\n  isDevMode = isDevMode();\r\n  isWindow = typeof window !== 'undefined';\r\n  _init = false;\r\n  private _elementToScroll: HTMLElement;\r\n  private _host: any; // scrolling window by default or element if [elementId] is given\r\n  private lastY = 0;\r\n  private ticking = false;\r\n\r\n  get currentPositionY(): number {\r\n    return this._elementToScroll ? this._elementToScroll.scrollTop : window.pageYOffset;\r\n  }\r\n  get info(): number { return Math.ceil(this.lastY); }\r\n  get showIcon(): boolean { return this.isWindow && this.lastY > DEFAULT_SCROLLED_PX; }\r\n\r\n  setDevMode() { this.isDevMode = true; }\r\n  log = (s?: any, ...optional: any[]) => s && this.isDevMode && console.log(s, optional);\r\n\r\n  constructor() { }\r\n\r\n  init(elementId: string) {\r\n    if (this.isWindow) {\r\n      this.destroy();\r\n\r\n      this._elementToScroll = null;\r\n      if (elementId) {\r\n        this._elementToScroll = document.querySelector(`#${elementId}`) as HTMLElement;\r\n      }\r\n\r\n      this._host = this._elementToScroll || window;\r\n      this._host.addEventListener('scroll', this.handleScroll);\r\n\r\n      this.log(`'NgScrolltopService' to use ${this._elementToScroll ? 'element' : 'window'}`, elementId || '');\r\n    }\r\n\r\n    this._init = true;\r\n  }\r\n\r\n  destroy() {\r\n    this.isWindow && this._host && this._host.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  scrollABit(newY) {\r\n    if (this._elementToScroll) {\r\n      this._elementToScroll.scrollTop = newY;\r\n    } else {\r\n      window.scroll(0, newY);\r\n    }\r\n  }\r\n\r\n  private handleScroll = (e) => {\r\n    if (!this.ticking) {\r\n      window.requestAnimationFrame(() => {\r\n        this.updateLastY()\r\n        this.ticking = false\r\n      })\r\n      this.ticking = true\r\n    }\r\n  }\r\n\r\n  private updateLastY() {\r\n    if (!this._init) return;\r\n\r\n    const newY = this.currentPositionY\r\n    if (newY !== this.lastY) {\r\n      this.lastY = newY;\r\n    }\r\n  }\r\n}\r\n","import { Component, Input, OnInit, OnDestroy } from '@angular/core';\r\nimport { NgScrolltopService } from './ng-scrolltop.service';\r\n\r\nconst setElementStyle = (elem: HTMLElement, name: string, value: string) => {\r\n  if (elem && name) {\r\n    elem.style[name] = value || '';\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'scrolltop',\r\n  template: `\r\n<div class=\"scroll-top\" blScrolltop\r\n  [ngClass]=\"{'show-icon': service.showIcon}\">\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" [attr.width]=\"sizeInner\" [attr.height]=\"sizeInner\" viewBox=\"0 0 24 24\"><path d=\"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>\r\n</div>\r\n\r\n<div class=\"scroll-top dev\" *ngIf=\"service.isDevMode\">\r\n  {{service.info}}\r\n</div>\r\n  `,\r\n  styles: [`\r\n  .scroll-top {\r\n    position: fixed;\r\n    bottom: 12px;\r\n    left: 12px;\r\n    height: 48px;\r\n    width: 48px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    border-radius: 50%;\r\n    background: #333;\r\n    transform: rotate(-90deg);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: visibility 1.0s linear, opacity 1.0s linear;\r\n  }\r\n  .scroll-top:hover {\r\n    cursor: pointer;\r\n  }\r\n  .scroll-top.show-icon {\r\n    visibility: visible;\r\n    opacity: 0.3;\r\n  }\r\n  .scroll-top.dev {\r\n    bottom: 150px;\r\n    visibility: visible;\r\n    opacity: 0.5;\r\n    transform: none;\r\n    color: #fff;\r\n  }\r\n    `],\r\n})\r\nexport class NgScrolltopComponent implements OnInit, OnDestroy {\r\n  private icon: HTMLElement;\r\n  private svg: HTMLElement;\r\n  private _bottom: string;\r\n  private _background: string;\r\n  private _elementId: string;\r\n  private _fill: string;\r\n  private _size: string = '48px';\r\n\r\n  @Input()\r\n  set bottom(value: string) {\r\n    this._bottom = value;\r\n    setElementStyle(this.icon, 'bottom', value);\r\n  }\r\n  @Input()\r\n  set background(value: string) {\r\n    this._background = value;\r\n    setElementStyle(this.icon, 'background', value);\r\n  }\r\n  @Input()\r\n  set elementId(value: string) {\r\n    this._elementId = value;\r\n    this.service.init(value);\r\n  }\r\n  @Input() \r\n  set size(value: string) {\r\n    this._size = value;\r\n    setElementStyle(this.icon, 'width', value);\r\n    setElementStyle(this.icon, 'height', value);\r\n  }\r\n  @Input() sizeInner: string = '24';\r\n  @Input() \r\n  set fill(value: string) {\r\n    this._fill = value;\r\n    setElementStyle(this.svg, 'fill', value);\r\n  }\r\n\r\n  constructor(public service: NgScrolltopService) { }\r\n\r\n  ngOnInit() {\r\n\r\n    this.service.init(this._elementId);\r\n\r\n    this.icon = document.querySelector('div.scroll-top:not(.dev)') as HTMLElement;\r\n    this.svg = document.querySelector('div.scroll-top:not(.dev) svg') as HTMLElement;\r\n    if (this.icon) {\r\n      setElementStyle(this.icon, 'bottom', this._bottom);\r\n      setElementStyle(this.icon, 'background', this._background);\r\n      setElementStyle(this.icon, 'width', this._size);\r\n      setElementStyle(this.icon, 'height', this._size);\r\n      setElementStyle(this.svg, 'fill', this._fill);\r\n    } else {\r\n      this.service.log(`NgScrolltopComponent failed to find icon element, so any inputs will be ignored`);\r\n    }\r\n\r\n    this.service.log(`NgScrolltopComponent(${this.service.isWindow}, ${this._bottom}, ${this._background}, ${this._elementId})`, this.icon && this.icon.style);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.service.destroy();\r\n  }\r\n}\r\n","import { Directive, HostListener, NgZone } from '@angular/core';\r\nimport { NgScrolltopService } from './ng-scrolltop.service';\r\n\r\nconst DURATION = 1000;\r\n\r\n@Directive({\r\n  selector: '[blScrolltop]'\r\n})\r\nexport class NgScrolltopDirective {\r\n  startTime: number = null;\r\n  startTop: number = null;\r\n  progress: number = 0;\r\n\r\n  constructor(public service: NgScrolltopService,\r\n    private ngZone: NgZone) {\r\n    this.scrollABit = this.scrollABit.bind(this);\r\n  }\r\n\r\n  @HostListener('click')\r\n  onclick() {\r\n    this.startTop = this.service.currentPositionY;\r\n    this.startTime = null;\r\n    this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n\r\n    this.service.log('NgScrolltopDirective click');\r\n  }\r\n\r\n  easing = (x) => {\r\n    'use strict';\r\n\r\n    if (x < 0.5) {\r\n      return Math.pow(x * 2, 2) / 2;\r\n    }\r\n    return 1 - Math.pow((1 - x) * 2, 2) / 2;\r\n  }\r\n\r\n  scrollABit(timestamp) {\r\n    if (!this.startTime) {\r\n      this.startTime = timestamp;\r\n    }\r\n\r\n    this.progress = timestamp - this.startTime;\r\n    const percent = (this.progress >= DURATION ? 1 : this.easing(this.progress / DURATION));\r\n    const newY = this.startTop - Math.ceil(this.startTop * percent);\r\n\r\n    this.service.scrollABit(newY);\r\n\r\n    if (percent < 1) {\r\n      this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgScrolltopComponent } from './ng-scrolltop.component';\r\nimport { NgScrolltopDirective } from './ng-scrolltop.directive';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n  ],\r\n  declarations: [\r\n    NgScrolltopComponent,\r\n    NgScrolltopDirective,\r\n  ],\r\n  exports: [\r\n    NgScrolltopComponent,\r\n    NgScrolltopDirective,\r\n  ]\r\n})\r\nexport class NgScrolltopModule { }\r\n"],"names":[],"mappings":"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"}