{"version":3,"file":"ng-scrolltop.umd.js","sources":["ng://ng-scrolltop/lib/ng-scrolltop.service.ts","ng://ng-scrolltop/lib/ng-scrolltop.component.ts","ng://ng-scrolltop/lib/ng-scrolltop.directive.ts","ng://ng-scrolltop/lib/ng-scrolltop.module.ts"],"sourcesContent":["import { Injectable, isDevMode } from '@angular/core';\r\n\r\nconst DEFAULT_SCROLLED_PX = 500;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgScrolltopService {\r\n  isDevMode = isDevMode();\r\n  isWindow = typeof window !== 'undefined';\r\n  _init = false;\r\n  private _elementToScroll: HTMLElement;\r\n  private _host: any; // scrolling window by default or element if [elementId] is given\r\n  private lastY = 0;\r\n  private ticking = false;\r\n\r\n  get currentPositionY(): number {\r\n    return this._elementToScroll ? this._elementToScroll.scrollTop : window.pageYOffset;\r\n  }\r\n  get info(): number { return Math.ceil(this.lastY); }\r\n  get showIcon(): boolean { return this.isWindow && this.lastY > DEFAULT_SCROLLED_PX; }\r\n\r\n  setDevMode() { this.isDevMode = true; }\r\n  log = (s?: any, ...optional: any[]) => s && this.isDevMode && console.log(s, optional);\r\n\r\n  constructor() { }\r\n\r\n  init(elementId: string) {\r\n    if (this.isWindow) {\r\n      this.destroy();\r\n\r\n      this._elementToScroll = null;\r\n      if (elementId) {\r\n        this._elementToScroll = document.querySelector(`#${elementId}`) as HTMLElement;\r\n      }\r\n\r\n      this._host = this._elementToScroll || window;\r\n      this._host.addEventListener('scroll', this.handleScroll);\r\n\r\n      this.log(`'NgScrolltopService' to use ${this._elementToScroll ? 'element' : 'window'}`, elementId || '');\r\n    }\r\n\r\n    this._init = true;\r\n  }\r\n\r\n  destroy() {\r\n    this.isWindow && this._host && this._host.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  scrollABit(newY) {\r\n    if (this._elementToScroll) {\r\n      this._elementToScroll.scrollTop = newY;\r\n    } else {\r\n      window.scroll(0, newY);\r\n    }\r\n  }\r\n\r\n  private handleScroll = (e) => {\r\n    if (!this.ticking) {\r\n      window.requestAnimationFrame(() => {\r\n        this.updateLastY()\r\n        this.ticking = false\r\n      })\r\n      this.ticking = true\r\n    }\r\n  }\r\n\r\n  private updateLastY() {\r\n    if (!this._init) return;\r\n\r\n    const newY = this.currentPositionY\r\n    if (newY !== this.lastY) {\r\n      this.lastY = newY;\r\n    }\r\n  }\r\n}\r\n","import { Component, Input, OnInit, OnDestroy } from '@angular/core';\r\nimport { NgScrolltopService } from './ng-scrolltop.service';\r\n\r\nconst setElementStyle = (elem: HTMLElement, name: string, value: string) => {\r\n  if (elem && name) {\r\n    elem.style[name] = value || '';\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'scrolltop',\r\n  template: `\r\n<div class=\"scroll-top\" blScrolltop\r\n  [ngClass]=\"{'show-icon': service.showIcon}\">\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" [attr.width]=\"sizeInner\" [attr.height]=\"sizeInner\" viewBox=\"0 0 24 24\"><path d=\"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>\r\n</div>\r\n\r\n<div class=\"scroll-top dev\" *ngIf=\"service.isDevMode\">\r\n  {{service.info}}\r\n</div>\r\n  `,\r\n  styles: [`\r\n  .scroll-top {\r\n    position: fixed;\r\n    bottom: 12px;\r\n    left: 12px;\r\n    height: 48px;\r\n    width: 48px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    border-radius: 50%;\r\n    background: #333;\r\n    transform: rotate(-90deg);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: visibility 1.0s linear, opacity 1.0s linear;\r\n  }\r\n  .scroll-top:hover {\r\n    cursor: pointer;\r\n  }\r\n  .scroll-top.show-icon {\r\n    visibility: visible;\r\n    opacity: 0.3;\r\n  }\r\n  .scroll-top.dev {\r\n    bottom: 150px;\r\n    visibility: visible;\r\n    opacity: 0.5;\r\n    transform: none;\r\n    color: #fff;\r\n  }\r\n    `],\r\n})\r\nexport class NgScrolltopComponent implements OnInit, OnDestroy {\r\n  private icon: HTMLElement;\r\n  private svg: HTMLElement;\r\n  private _bottom: string;\r\n  private _background: string;\r\n  private _elementId: string;\r\n  private _fill: string;\r\n  private _size: string = '48px';\r\n\r\n  @Input()\r\n  set bottom(value: string) {\r\n    this._bottom = value;\r\n    setElementStyle(this.icon, 'bottom', value);\r\n  }\r\n  @Input()\r\n  set background(value: string) {\r\n    this._background = value;\r\n    setElementStyle(this.icon, 'background', value);\r\n  }\r\n  @Input()\r\n  set elementId(value: string) {\r\n    this._elementId = value;\r\n    this.service.init(value);\r\n  }\r\n  @Input() \r\n  set size(value: string) {\r\n    this._size = value;\r\n    setElementStyle(this.icon, 'width', value);\r\n    setElementStyle(this.icon, 'height', value);\r\n  }\r\n  @Input() sizeInner: string = '24';\r\n  @Input() \r\n  set fill(value: string) {\r\n    this._fill = value;\r\n    setElementStyle(this.svg, 'fill', value);\r\n  }\r\n\r\n  constructor(public service: NgScrolltopService) { }\r\n\r\n  ngOnInit() {\r\n\r\n    this.service.init(this._elementId);\r\n\r\n    this.icon = document.querySelector('div.scroll-top:not(.dev)') as HTMLElement;\r\n    this.svg = document.querySelector('div.scroll-top:not(.dev) svg') as HTMLElement;\r\n    if (this.icon) {\r\n      setElementStyle(this.icon, 'bottom', this._bottom);\r\n      setElementStyle(this.icon, 'background', this._background);\r\n      setElementStyle(this.icon, 'width', this._size);\r\n      setElementStyle(this.icon, 'height', this._size);\r\n      setElementStyle(this.svg, 'fill', this._fill);\r\n    } else {\r\n      this.service.log(`NgScrolltopComponent failed to find icon element, so any inputs will be ignored`);\r\n    }\r\n\r\n    this.service.log(`NgScrolltopComponent(${this.service.isWindow}, ${this._bottom}, ${this._background}, ${this._elementId})`, this.icon && this.icon.style);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.service.destroy();\r\n  }\r\n}\r\n","import { Directive, HostListener, NgZone } from '@angular/core';\r\nimport { NgScrolltopService } from './ng-scrolltop.service';\r\n\r\nconst DURATION = 1000;\r\n\r\n@Directive({\r\n  selector: '[blScrolltop]'\r\n})\r\nexport class NgScrolltopDirective {\r\n  startTime: number = null;\r\n  startTop: number = null;\r\n  progress: number = 0;\r\n\r\n  constructor(public service: NgScrolltopService,\r\n    private ngZone: NgZone) {\r\n    this.scrollABit = this.scrollABit.bind(this);\r\n  }\r\n\r\n  @HostListener('click')\r\n  onclick() {\r\n    this.startTop = this.service.currentPositionY;\r\n    this.startTime = null;\r\n    this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n\r\n    this.service.log('NgScrolltopDirective click');\r\n  }\r\n\r\n  easing = (x) => {\r\n    'use strict';\r\n\r\n    if (x < 0.5) {\r\n      return Math.pow(x * 2, 2) / 2;\r\n    }\r\n    return 1 - Math.pow((1 - x) * 2, 2) / 2;\r\n  }\r\n\r\n  scrollABit(timestamp) {\r\n    if (!this.startTime) {\r\n      this.startTime = timestamp;\r\n    }\r\n\r\n    this.progress = timestamp - this.startTime;\r\n    const percent = (this.progress >= DURATION ? 1 : this.easing(this.progress / DURATION));\r\n    const newY = this.startTop - Math.ceil(this.startTop * percent);\r\n\r\n    this.service.scrollABit(newY);\r\n\r\n    if (percent < 1) {\r\n      this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgScrolltopComponent } from './ng-scrolltop.component';\r\nimport { NgScrolltopDirective } from './ng-scrolltop.directive';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n  ],\r\n  declarations: [\r\n    NgScrolltopComponent,\r\n    NgScrolltopDirective,\r\n  ],\r\n  exports: [\r\n    NgScrolltopComponent,\r\n    NgScrolltopDirective,\r\n  ]\r\n})\r\nexport class NgScrolltopModule { }\r\n"],"names":["isDevMode","Injectable","Component","Input","Directive","NgZone","HostListener","NgModule","CommonModule"],"mappings":"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"}